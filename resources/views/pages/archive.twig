{# Archive template for terms, categories, post type pages and ArchivePageComponent pages #}
{# This template reuses the `page` classes from page.twig #}
{% extends 'pages/page.twig' %}

{# Support ArchivePageComponent #}
{% set object = object ?: term|default(post) %}
{% set taxonomy = term.taxonomy|default(post.archive__post_type) %}
{% set content = term.description|default(post.content)|the_content %}

{%
  set page_classes = page_classes ?: [
    'page',
    'page--'~template_type,
    'page--type-'~taxonomy,
    'archive',
    'grid-container',
    'grid-container-padded',
  ]
%}

{% block content %}
  <div class="{{page_classes|join(' ')}}" id="archive-{{object.ID}}">
    <div class="grid-x grid-margin-x grid-margin-y">
      {# Archive term or post #}
      {% block term %}
        <article class="page__term cell grid-x align-center">
          <div class="cell auto">
            <div class="page__content-wrapper grid-x grid-margin-x grid-margin-y">

              {# Heading #}
              {% block page__header %}
                <div class="page__title-wrapper cell">
                  <h1 class="page__title">{% block page__title object.title|default(wp_title) %}</h1>
                </div>
              {% endblock %}

              {# Content #}
              {% block page__content %}
                {% if content %}
                  <div class="page__content cell">
                    {{content}}
                  </div>
                {% endif %}
              {% endblock %}
              {% block page__footer parent() %}
            </div><!-- .page__content-wrapper -->
          </div><!-- .cell.auto -->

          {% block page__sidebar parent() %}
          {% block page__after parent() %}
        </article>
      {% endblock %}

      {# Archive listing #}
      {% block listing %}
        {% block listing__loop %}
          <section class="page__listing cell">
            <div class="grid-x grid-margin-x grid-margin-y small-up-1 medium-up-2 large-up-3 align-stretch align-center">
              {% for archive_post in posts %}
                {% block listing__item %}
                  <div class="cell">
                    {% include ['teasers/teaser--'~archive_post.post_type~'.twig', 'teasers/teaser.twig'] with { post: archive_post } %}
                  </div>
                {% endblock %}
              {% endfor %}
            </div>
          </section>
        {% endblock %}

        {% block listing__pager %}
          {% if posts.pagination.prev.link or posts.pagination.next.link %}
            <div class="page__listing_pager cell">
              {% include 'parts/archive__pager.twig' %}
            </div>
          {% endif %}
        {% endblock %}

      {% endblock listing %}
    </div><!-- .grid-x -->
    {% block page__grid_after parent() %}
  </div><!-- .page -->
{% endblock %}
